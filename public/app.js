// Generated by CoffeeScript 1.4.0
(function() {
  var audioElement, current_index, items, root, urls;

  urls = ['./words.json', './words2.json'];

  items = [];

  current_index = 0;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  audioElement = document.createElement("audio");

  $(function() {
    var url, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = urls.length; _i < _len; _i++) {
      url = urls[_i];
      _results.push($.getJSON(url, function(data) {
        Array.prototype.push.apply(items, data["review"]["trainer_items"]);
        return load_item();
      }));
    }
    return _results;
  });

  root.load_next_item = function() {
    if ($('#danish').html() === '&nbsp;') {
      return $('#danish').html(items[current_index]['l2_text']);
    } else {
      current_index += 1;
      if (current_index >= items.length) {
        current_index = 0;
      }
      return load_item();
    }
  };

  root.load_item = function() {
    $('#danish').html('&nbsp;');
    $('#english').html(items[current_index]['l1_text']);
    return $('#counter').html("" + (current_index + 1) + " / " + items.length);
  };

  root.play = function() {
    var text;
    if ($('#danish').html() === '&nbsp;') {
      $('#danish').html(items[current_index]['l2_text']);
    }
    text = items[current_index]['l2_text'];
    audioElement.setAttribute("src", "/say/" + text);
    audioElement.setAttribute("autoplay", "autoplay");
    $.get();
    return audioElement.addEventListener("load", function() {
      return audioElement.play();
    });
  };

}).call(this);
