// Generated by CoffeeScript 1.4.0
(function() {
  var audioElement, current_index, items, root, url;

  url = './words.json';

  items = [];

  current_index = 0;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  audioElement = document.createElement("audio");

  $(function() {
    return $.getJSON(url, function(data) {
      var item, _i, _len, _ref, _results;
      items = data["review"]["trainer_items"];
      console.log('about to call load_next_item');
      load_item();
      _ref = data["review"]["trainer_items"];
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        item = _ref[_i];
        _results.push(console.log(item));
      }
      return _results;
    });
  });

  root.load_next_item = function() {
    if ($('#danish').html() === '&nbsp;') {
      return $('#danish').html(items[current_index]['l2_text']);
    } else {
      current_index += 1;
      if (current_index >= items.length) {
        current_index = 0;
      }
      return load_item();
    }
  };

  root.load_item = function() {
    $('#danish').html('&nbsp;');
    $('#english').html(items[current_index]['l1_text']);
    return $('#counter').html("" + (current_index + 1) + " / " + items.length);
  };

  root.play = function() {
    var text;
    text = items[current_index]['l2_text'];
    audioElement.setAttribute("src", "/say/" + text);
    audioElement.setAttribute("autoplay", "autoplay");
    $.get();
    return audioElement.addEventListener("load", function() {
      return audioElement.play();
    });
  };

}).call(this);
